---
title: 雅虎军规
time: 2015.12.29 
layout: post
tags:
- 笔记
- 性能优化
excerpt: 本文主要记录了WEB性能优化的方法。
---

###尽可能减少HTTP请求的次数
HTTP请求：从客户端到服务器端的请求消息。包括消息首行中，对资源的请求方法、资源标识符以及请求的协议。
可以将文字、图片、JS、CSS分别合并成一个文件。

###使用CDN（内容分发网络）

###添加Expire/Cache-Control头
expire的HTTP头的内容是一个时间值，值就是资源在本地的过期时间、存在本地。在本地缓存阶段，找到一个对应的资源值。当前时间还没超过资源的过期时间，就直接使用这个资源，不会发送HTTP请求。
Cache-Control是HTTP协议中常用的头部之一，负责控制页面的缓存机制。如果该头部指示缓存，缓存的内容也会存在本地。

###Gzip压缩
先在服务器端压缩文件，然后在浏览器解压缩（最好是先在本地压缩一次后，上传服务器进行再次压缩）。

###将CSS放在页面最上面
在IE下，如果将CSS放在页面底部，IE阻止页面的显示以免重画页面元素，在网络较差的情况下用户只能看到空白的页面。Firefox虽然不会阻止页面元素的显示，但部分元素需要重画，会造成页面的闪烁。

###把script放在页面最下面
先将页面样式呈现给用户，再加载并执行脚本文件。

###避免在CSS中使用Expressions
CSS Expressions指CSS属性的值是用一段JS代码计算的。在页面的显示和缩放/页面滚动/移动鼠标的时候都需要重新计算一次。

###把JavaScript和CSS都放到外部文件中
将JS和CSS作为单独的脚本引用，好处是提高了JS和CSS的复用性，减小HTML页面的体积，提高了JS和CSS的可维护性。缺点是在脚本数量较多时会增加HTTP请求的次数。
将JS和CSS写在HTML页面的好处是可以减少页面的请求，提升页面的渲染速度。当样式和脚本只适用于一个页面或者页面不经常被访问或者脚本和样式很少时，应该把JS和CSS写在HTML页面里。

###减少DNS查询
DNS查询：计算机将域名转换为IP地址，通过这个IP地址在服务器上查找到域名对应的网站资源。大约需要20ms。因此需要将DNS查找过程缓存。IE中DNS默认的缓存时间是30min，firefox是60s，chrome是60s。当缓存时间长时，浏览器会直接从缓存中获取，减少DNS的重复查找，节省时间。当缓存时间短时，浏览器可以及时检测网站服务器的正确性，保证正确性。

###压缩JS和CSS
去除不必要的空白符、格式符、注释符；
简写方法名、参数名压缩JS脚本；

###避免重定向
重定向：原始请求被重新转向到了其他请求。
重定向状态码：301（永久重定向），表示用户请求的页面被移动到了另外位置，客户端收到这个反馈后会再发出另外的请求到那个位置下载所需的资源；302（临时重定向），表示用户请求的页面被找到，但不在原始位置，服务器会返回页面所在的地址，客户端收到地址后会发出请求下载资源。对于搜索引擎来说，如果是301，它会删除之前的地址并更新现在的地址，使搜索引擎更加智能；如果是302，它总是先找到旧地址再跳新地址。但无论是哪种重定向，都应该避免使用，因为会增加HTTP请求次数。

###移除重复的脚本

###配置实体标签（ETag）
ETag:Entity Tag(实体标签)，使用特殊的字符串来标识某个请求资源版本，属于HTTP协议，受WEB服务支持。
当用户通过浏览器向服务器请求资源时，服务器会与本地缓存进行比较，如果两边的ETag一致，说明该资源没有被修改过，服务器会返回304（与本地缓存一致，可以使用缓存中的资源）。

###使用AJAX缓存
AJAX:异步的JS和XML。使网页分批加载、局部更新。
POST请求：每次都需要发给服务器进行处理，服务器会返回状态码200，这种请求是不能被缓存的。
GET请求：对于同一地址的AJAX请求不会重复执行，除非是指定了不同的地址，服务器返回的状态码是304，这种请求是可以被缓存的。
